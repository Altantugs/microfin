{% extends 'base.html.twig' %}
{% block title %}Нэвтрэх{% endblock %}

{% block body %}
<h1>Нэвтрэх</h1>

<style>
  .auth{max-width:360px;margin:16px 0}
  .auth label{display:block;margin:10px 0 6px}
  .auth input[type="text"], .auth input[type="email"], .auth input[type="password"]{
    width:100%;padding:10px;border:1px solid #d1d5db;border-radius:6px
  }
  .row{display:flex;justify-content:space-between;align-items:center;margin-top:10px}
  .btn{padding:10px 14px;border:1px solid #111;border-radius:6px;background:#111;color:#fff;cursor:pointer}
  .alert{padding:10px 12px;border-radius:6px;margin:10px 0}
  .alert.error{background:#fee2e2;color:#991b1b}
  .alert.success{background:#dcfce7;color:#166534}
  .muted{color:#6b7280;font-size:12px}
</style>

<div class="auth" role="region" aria-labelledby="login-title">
  {% if error %}
    <div class="alert error" role="alert">
      {{ error.messageKey|trans(error.messageData, 'security') }}
    </div>
  {% endif %}

  {% for msg in app.flashes('success') %}
    <div class="alert success" role="status">{{ msg }}</div>
  {% endfor %}
  {% for msg in app.flashes('error') %}
    <div class="alert error" role="alert">{{ msg }}</div>
  {% endfor %}

  {% if app.user %}
    <p class="muted">
      Нэвтэрсэн: <strong>{{ app.user.userIdentifier ?? app.user.email }}</strong>
      — <a href="{{ path('app_logout') }}">Гарах</a>
    </p>
  {% else %}
    <form method="post" action="{{ path('app_login') }}" aria-describedby="login-help">
      <label for="email">Имэйл</label>
      <input id="email" type="email" name="email" value="{{ last_username|default('') }}"
             autocomplete="email" required autofocus>

      <label for="password">Нууц үг</label>
      <input id="password" type="password" name="password" autocomplete="current-password" required>

      <input type="hidden" name="_csrf_token" value="{{ csrf_token('authenticate') }}">

      <div id="login-help" class="muted">Нэвтрэхдээ имэйл хаяг, нууц үгээ зөв оруулна уу.</div>

      <div class="row">
        <label class="muted" style="display:flex;gap:6px;align-items:center">
          <input type="checkbox" name="_remember_me" value="on"> Намайг сана (14 хоног)
        </label>
        <button class="btn" type="submit">Нэвтрэх</button>
      </div>
    </form>
  {% endif %}
</div>
{% endblock %}
